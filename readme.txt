The code is written in python3. Necessary packages are imported in .py files. To run the code, you need to modify the dataset path to your dataset path. Default dataset path is on Kaggle. Initially, I run the code on Kaggle notebook. However, running on command line is also workable.

There are two .csv files. submission.csv is the result of kaggle.py. submission2.csv is the result of kaggle2.py.